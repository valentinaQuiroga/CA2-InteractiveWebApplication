{"version":3,"sources":["webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/lang/en_US.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/lang/zh_CN.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/register.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/utils/date.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/index.js","webpack://javascript-fullstack-simple/./frontend/UI.js","webpack://javascript-fullstack-simple/./frontend/services/ItemService.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/format.js","webpack://javascript-fullstack-simple/./frontend/app.js"],"names":["EN_US","ZH_CN","Locales","register","locale","func","SEC_ARRAY","toDate","input","Date","isNaN","test","parseInt","trim","replace","diff","idx","unit","Math","floor","itemService","this","URI","res","fetch","json","item","method","body","data","console","log","itemId","headers","items","getItems","itemsCardContainer","document","getElementById","innerHTML","forEach","div","createElement","date","opts","className","imagePath","article","author","_id","created_at","localeFunc","agoIn","totalSec","abs","length","toString","relativeDate","appendChild","postItem","clearItemForm","renderItems","reset","message","colorMessage","secondsToRemove","createTextNode","container","querySelector","itemForm","insertBefore","setTimeout","remove","deleteItem","addEventListener","e","artType","value","price","image","files","formData","FormData","append","ui","addNewItem","renderMessage","preventDefault","target","classList","contains","id","getAttribute"],"mappings":"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","file":"js/bundle.js","sourcesContent":["var EN_US = ['second', 'minute', 'hour', 'day', 'week', 'month', 'year'];\nexport default function (diff, idx) {\n    if (idx === 0)\n        return ['just now', 'right now'];\n    var unit = EN_US[Math.floor(idx / 2)];\n    if (diff > 1)\n        unit += 's';\n    return [diff + \" \" + unit + \" ago\", \"in \" + diff + \" \" + unit];\n}\n//# sourceMappingURL=en_US.js.map","var ZH_CN = ['秒', '分钟', '小时', '天', '周', '个月', '年'];\nexport default function (diff, idx) {\n    if (idx === 0)\n        return ['刚刚', '片刻后'];\n    var unit = ZH_CN[~~(idx / 2)];\n    return [diff + \" \" + unit + \"\\u524D\", diff + \" \" + unit + \"\\u540E\"];\n}\n//# sourceMappingURL=zh_CN.js.map","/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n/**\n * All supported locales\n */\nvar Locales = {};\n/**\n * register a locale\n * @param locale\n * @param func\n */\nexport var register = function (locale, func) {\n    Locales[locale] = func;\n};\n/**\n * get a locale, default is en_US\n * @param locale\n * @returns {*}\n */\nexport var getLocale = function (locale) {\n    return Locales[locale] || Locales['en_US'];\n};\n//# sourceMappingURL=register.js.map","/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\nvar SEC_ARRAY = [\n    60,\n    60,\n    24,\n    7,\n    365 / 7 / 12,\n    12,\n];\n/**\n * format Date / string / timestamp to timestamp\n * @param input\n * @returns {*}\n */\nexport function toDate(input) {\n    if (input instanceof Date)\n        return input;\n    // @ts-ignore\n    if (!isNaN(input) || /^\\d+$/.test(input))\n        return new Date(parseInt(input));\n    input = (input || '')\n        // @ts-ignore\n        .trim()\n        .replace(/\\.\\d+/, '') // remove milliseconds\n        .replace(/-/, '/')\n        .replace(/-/, '/')\n        .replace(/(\\d)T(\\d)/, '$1 $2')\n        .replace(/Z/, ' UTC') // 2017-2-5T3:57:52Z -> 2017-2-5 3:57:52UTC\n        .replace(/([+-]\\d\\d):?(\\d\\d)/, ' $1$2'); // -04:00 -> -0400\n    return new Date(input);\n}\n/**\n * format the diff second to *** time ago, with setting locale\n * @param diff\n * @param localeFunc\n * @returns\n */\nexport function formatDiff(diff, localeFunc) {\n    /**\n     * if locale is not exist, use defaultLocale.\n     * if defaultLocale is not exist, use build-in `en`.\n     * be sure of no error when locale is not exist.\n     *\n     * If `time in`, then 1\n     * If `time ago`, then 0\n     */\n    var agoIn = diff < 0 ? 1 : 0;\n    /**\n     * Get absolute value of number (|diff| is non-negative) value of x\n     * |diff| = diff if diff is positive\n     * |diff| = -diff if diff is negative\n     * |0| = 0\n     */\n    diff = Math.abs(diff);\n    /**\n     * Time in seconds\n     */\n    var totalSec = diff;\n    /**\n     * Unit of time\n     */\n    var idx = 0;\n    for (; diff >= SEC_ARRAY[idx] && idx < SEC_ARRAY.length; idx++) {\n        diff /= SEC_ARRAY[idx];\n    }\n    /**\n     * Math.floor() is alternative of ~~\n     *\n     * The differences and bugs:\n     * Math.floor(3.7) -> 4 but ~~3.7 -> 3\n     * Math.floor(1559125440000.6) -> 1559125440000 but ~~1559125440000.6 -> 52311552\n     *\n     * More information about the performance of algebraic:\n     * https://www.youtube.com/watch?v=65-RbBwZQdU\n     */\n    diff = Math.floor(diff);\n    idx *= 2;\n    if (diff > (idx === 0 ? 9 : 1))\n        idx += 1;\n    return localeFunc(diff, idx, totalSec)[agoIn].replace('%s', diff.toString());\n}\n/**\n * calculate the diff second between date to be formatted an now date.\n * @param date\n * @param relativeDate\n * @returns {number}\n */\nexport function diffSec(date, relativeDate) {\n    var relDate = relativeDate ? toDate(relativeDate) : new Date();\n    return (+relDate - +toDate(date)) / 1000;\n}\n/**\n * nextInterval: calculate the next interval time.\n * - diff: the diff sec between now and date to be formatted.\n *\n * What's the meaning?\n * diff = 61 then return 59\n * diff = 3601 (an hour + 1 second), then return 3599\n * make the interval with high performance.\n **/\nexport function nextInterval(diff) {\n    var rst = 1, i = 0, d = Math.abs(diff);\n    for (; diff >= SEC_ARRAY[i] && i < SEC_ARRAY.length; i++) {\n        diff /= SEC_ARRAY[i];\n        rst *= SEC_ARRAY[i];\n    }\n    d = d % rst;\n    d = d ? rst - d : rst;\n    return Math.ceil(d);\n}\n//# sourceMappingURL=date.js.map","/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\nimport en_US from './lang/en_US';\nimport zh_CN from './lang/zh_CN';\nimport { register } from './register';\nregister('en_US', en_US);\nregister('zh_CN', zh_CN);\nexport { format } from './format';\nexport { render, cancel } from './realtime';\nexport { register };\n//# sourceMappingURL=index.js.map","//INTERFACE for the ItemServer functions\r\nimport ItemService from \"./services/ItemService\";\r\nconst itemService = new ItemService();\r\n\r\nimport { format } from \"timeago.js\";\r\n\r\nclass UI {\r\n  async renderItems() {\r\n    const items = await itemService.getItems();\r\n    const itemsCardContainer = document.getElementById(\"items-cards\");\r\n    itemsCardContainer.innerHTML = \"\";\r\n    items.forEach((item) => {\r\n      const div = document.createElement(\"div\");\r\n      div.className = \"\";\r\n      div.innerHTML = `\r\n      <div class=\"card m-2\">\r\n        <div class=\"row\">\r\n            <div class=\"col-md-4\">\r\n                <img src=\"http://localhost:3000${\r\n                  item.imagePath\r\n                }\" class=\"img-fluid\" alt=\"\">\r\n            </div>\r\n            <div class=\"col-md-8\">\r\n                <div class=\"card-block px-2\">\r\n                    <h4 class=\"card-title\">${item.article}</h4>\r\n                    <p class=\"card-text\">${item.author}</p>\r\n                    <a href=\"#\" class=\"btn btn-danger delete\" _id=\"${\r\n                      item._id\r\n                    }\">X</a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"card-footer w-100 text-muted\">\r\n          ${format(item.created_at)}\r\n        </div>\r\n      </div>\r\n      `;\r\n      itemsCardContainer.appendChild(div);\r\n    });\r\n  }\r\n\r\n  async addNewItem(item) {\r\n    await itemService.postItem(item);\r\n    this.clearItemForm();\r\n    this.renderItems();\r\n  }\r\n\r\n  clearItemForm() {\r\n    document.getElementById(\"item-form\").reset();\r\n  }\r\n\r\n  renderMessage(message, colorMessage, secondsToRemove) {\r\n    const div = document.createElement(\"div\");\r\n    div.className = `message alert alert-${colorMessage}`;\r\n    div.appendChild(document.createTextNode(message));\r\n\r\n    const container = document.querySelector(\".containerMessage\");\r\n    const itemForm = document.querySelector(\"#item-form\");\r\n\r\n    container.insertBefore(div, itemForm);\r\n    setTimeout(() => {\r\n      document.querySelector(\".message\").remove();\r\n    }, secondsToRemove);\r\n  }\r\n\r\n  async deleteItem(itemId) {\r\n    await itemService.deleteItem(itemId);\r\n    this.renderItems();\r\n  }\r\n}\r\n\r\nexport default UI;\r\n","class ItemService {\r\n  constructor() {\r\n    this.URI = \"http://localhost:3000/api/items\";\r\n  }\r\n\r\n  async getItems() {\r\n    const res = await fetch(this.URI);\r\n    // convert the String response to json\r\n    const items = await res.json();\r\n    return items;\r\n  }\r\n\r\n  async postItem(item) {\r\n    const res = await fetch(this.URI, {\r\n      method: \"POST\",\r\n      body: item,\r\n    });\r\n    const data = await res.json();\r\n    console.log(data);\r\n  }\r\n\r\n  async deleteItem(itemId) {\r\n    const res = await fetch(`${this.URI}/${itemId}`, {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"DELETE\",\r\n    });\r\n    const data = await res.json();\r\n    console.log(data);\r\n  }\r\n}\r\n\r\nexport default ItemService;\r\n","import { formatDiff, diffSec } from './utils/date';\nimport { getLocale } from './register';\n/**\n * format a TDate into string\n * @param date\n * @param locale\n * @param opts\n */\nexport var format = function (date, locale, opts) {\n    // diff seconds\n    var sec = diffSec(date, opts && opts.relativeDate);\n    // format it with locale\n    return formatDiff(sec, getLocale(locale));\n};\n//# sourceMappingURL=format.js.map","import \"./styles/app.css\";\r\n\r\nimport UI from \"./UI\";\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  const ui = new UI();\r\n  ui.renderItems();\r\n});\r\n\r\n//id of the form\r\ndocument.getElementById(\"item-form\").addEventListener(\"submit\", (e) => {\r\n  const artType = document.getElementById(\"artType\").value;\r\n  const article = document.getElementById(\"article\").value;\r\n  const author = document.getElementById(\"author\").value;\r\n  const price = document.getElementById(\"price\").value;\r\n  const image = document.getElementById(\"image\").files;\r\n\r\n  //groupdata to send all together\r\n  const formData = new FormData();\r\n  formData.append(\"image\", image[0]);\r\n  formData.append(\"artType\", artType);\r\n  formData.append(\"article\", article);\r\n  formData.append(\"author\", author);\r\n  formData.append(\"price\", price);\r\n\r\n  const ui = new UI();\r\n  ui.addNewItem(formData);\r\n  ui.renderMessage(\"New Art Added to the Gallery\", \"success\", 2000);\r\n\r\n  //no reboot on submit\r\n  e.preventDefault();\r\n});\r\n\r\n//to delete de card with an item\r\ndocument.getElementById(\"items-cards\").addEventListener(\"click\", (e) => {\r\n  if (e.target.classList.contains(\"delete\")) {\r\n    const ui = new UI();\r\n    const id = e.target.getAttribute(\"_id\");\r\n    ui.deleteItem(id);\r\n    ui.renderMessage(\"Art removed from the Gallery\", \"danger\", 2000);\r\n  }\r\n  e.preventDefault();\r\n});\r\n"],"sourceRoot":""}